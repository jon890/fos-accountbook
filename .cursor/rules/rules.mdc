---
alwaysApply: true
description: ìš°ë¦¬ì§‘ ê°€ê³„ë¶€ í”„ë¡œì íŠ¸ì˜ ì „ì²´ ê°œë°œ ê·œì¹™ ë° ì»¨ë²¤ì…˜
version: "2.0"
---

# ìš°ë¦¬ì§‘ ê°€ê³„ë¶€ - Cursor AI ê°œë°œ ê·œì¹™

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

**í”„ë¡ íŠ¸ì—”ë“œ**: Next.js 15 + TypeScript + Tailwind CSS
**ë°±ì—”ë“œ**: Spring Boot + JPA + MySQL
**ì¸ì¦**: NextAuth.js (Google OAuth)
**ë°°í¬**: Vercel (Frontend) + Railway (Backend)

---

## ğŸ“‹ ì½”ë”© ì»¨ë²¤ì…˜

### 1. í”„ë¡ íŠ¸ì—”ë“œ (Next.js)

#### TypeScript ê·œì¹™

- âŒ **ì ˆëŒ€ `any` íƒ€ì… ì‚¬ìš© ê¸ˆì§€** - `unknown` ë˜ëŠ” ì •í™•í•œ íƒ€ì… ì‚¬ìš©
- âœ… **Zod ìŠ¤í‚¤ë§ˆ í•„ìˆ˜ ì‚¬ìš©**: ëª¨ë“  í¼ ë°ì´í„° ë° API ì…ë ¥ ê²€ì¦
- âœ… Zodì˜ `safeParse()` ì‚¬ìš©
- âœ… ì—ëŸ¬ëŠ” `error.flatten().fieldErrors` ì‚¬ìš©

#### íƒ€ì… êµ¬ì¡°

- **ë„ë©”ì¸ë³„ íƒ€ì… ë¶„ë¦¬**: `src/types/actions/` í´ë”ì— ë„ë©”ì¸ë³„ë¡œ êµ¬ì¡°í™”
  - `common.ts` - ê³µí†µ íƒ€ì…
  - `dashboard.ts` - ëŒ€ì‹œë³´ë“œ íƒ€ì…
  - `expense.ts` - ì§€ì¶œ íƒ€ì…
  - `family.ts` - ê°€ì¡± íƒ€ì…
  - `invitation.ts` - ì´ˆëŒ€ íƒ€ì…
  - `index.ts` - í†µí•© export

#### Next.js 15 ì•„í‚¤í…ì²˜

- **Server Components ìš°ì„ **: ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” Server Component
- **Server Actions ìš°ì„ **: ë°ì´í„° ë³€ê²½ì€ Server Actions ì‚¬ìš©
- **API Routes ìµœì†Œí™”**: ë‹¤ìŒ ê²½ìš°ì—ë§Œ ì‚¬ìš©
  - ì™¸ë¶€ Webhook ì²˜ë¦¬
  - ì¨ë“œíŒŒí‹° API í†µí•©
  - NextAuth.js ë“± ë¼ì´ë¸ŒëŸ¬ë¦¬ ìš”êµ¬ì‚¬í•­
- **Client ComponentëŠ” í•„ìš”ì‹œë§Œ**: ë‹¤ìŒ ê²½ìš°ì—ë§Œ 'use client'
  - ì‚¬ìš©ì ìƒí˜¸ì‘ìš© (onClick, onChange)
  - React Hooks (useState, useEffect)
  - ë¸Œë¼ìš°ì € ì „ìš© API

#### React 19 ê·œì¹™

```typescript
// âŒ Deprecated
import { useFormState } from "react-dom";

// âœ… React 19
import { useActionState } from "react";
const [state, formAction] = useActionState(action, initialState);
```

#### í¼ ì œì¶œ íŒ¨í„´

```typescript
// âœ… SubmitButton ì‚¬ìš© (ì¤‘ë³µ ì œì¶œ ë°©ì§€)
<form action={formAction}>
  <SubmitButton pendingText="ì €ì¥ ì¤‘...">ì €ì¥í•˜ê¸°</SubmitButton>
</form>
```

### 2. ë°±ì—”ë“œ (Spring Boot)

#### ì•„í‚¤í…ì²˜ íŒ¨í„´

- **Controller â†’ Service â†’ Repository** ê³„ì¸µ êµ¬ì¡°
- **EntityëŠ” snake_case**: ëª¨ë“  í…Œì´ë¸”ëª…ê³¼ ì»¬ëŸ¼ëª…ì€ snake_case
  - ì˜ˆ: `family_members`, `created_at`, `user_id`, `family_uuid`
- **UUID ê¸°ë°˜ ê´€ê³„**: ëª¨ë“  í…Œì´ë¸” ê°„ ì¡°ì¸ì€ UUIDë¡œ ìˆ˜í–‰
- **Soft Delete**: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹°ì— `deleted_at` ì»¬ëŸ¼

#### API ê·œì¹™

- **RESTful API ì„¤ê³„**: HTTP ë©”ì„œë“œë¥¼ ì˜¬ë°”ë¥´ê²Œ ì‚¬ìš©
  - GET: ì¡°íšŒ
  - POST: ìƒì„±
  - PUT: ì „ì²´ ìˆ˜ì •
  - PATCH: ë¶€ë¶„ ìˆ˜ì •
  - DELETE: ì‚­ì œ
- **DTO íŒ¨í„´**: Request/Responseìš© ë³„ë„ DTO í´ë˜ìŠ¤
- **ê³µí†µ ì‘ë‹µ í˜•ì‹**: `ApiSuccessResponse<T>`, `ApiErrorResponse`
- **ì—ëŸ¬ ì²˜ë¦¬**: `@ControllerAdvice`ë¡œ ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Frontend

- **Framework**: Next.js 15 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS v3
- **UI Components**: shadcn/ui
- **State Management**: React 19 Hooks
- **Form Validation**: Zod
- **Package Manager**: pnpm

### Backend

- **Framework**: Spring Boot 3.x
- **Language**: Java 17+
- **ORM**: JPA (Hibernate)
- **Database**: MySQL
- **Migration**: Flyway
- **API Documentation**: Swagger/OpenAPI
- **Build Tool**: Gradle

### Deployment

- **Frontend**: Vercel
- **Backend**: Railway
- **Authentication**: NextAuth.js (Google OAuth)

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

### Frontend (Next.js)

```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ actions/           # Server Actions (ë„ë©”ì¸ë³„)
â”‚   â”‚   â”œâ”€â”€ expense/
â”‚   â”‚   â”œâ”€â”€ family/
â”‚   â”‚   â””â”€â”€ dashboard/
â”‚   â”œâ”€â”€ api/               # API Routes (ìµœì†Œí™”)
â”‚   â””â”€â”€ (pages)/           # Page Components
â”œâ”€â”€ components/            # React Components
â”‚   â”œâ”€â”€ ui/               # shadcn/ui Components
â”‚   â”œâ”€â”€ common/           # ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ [domain]/         # ë„ë©”ì¸ë³„ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ lib/                  # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â”œâ”€â”€ server/          # ì„œë²„ ì „ìš© ìœ í‹¸
â”‚   â””â”€â”€ client/          # í´ë¼ì´ì–¸íŠ¸ ìœ í‹¸
â””â”€â”€ types/               # TypeScript íƒ€ì… ì •ì˜
    â””â”€â”€ actions/         # ë„ë©”ì¸ë³„ íƒ€ì…
```

### Backend (Spring Boot)

```
src/main/java/com/bifos/accountbook/
â”œâ”€â”€ presentation/         # Controller ë ˆì´ì–´
â”‚   â””â”€â”€ controller/
â”œâ”€â”€ application/         # Service & DTO ë ˆì´ì–´
â”‚   â”œâ”€â”€ service/
â”‚   â””â”€â”€ dto/
â”œâ”€â”€ domain/              # Domain ë ˆì´ì–´
â”‚   â”œâ”€â”€ entity/
â”‚   â””â”€â”€ repository/
â””â”€â”€ infra/               # Infrastructure ë ˆì´ì–´
    â””â”€â”€ persistence/
```

---

## ğŸš€ ê°œë°œ ê°€ì´ë“œë¼ì¸

### 1. Server Actions íŒ¨í„´ (í”„ë¡ íŠ¸ì—”ë“œ)

```typescript
// src/app/actions/expense/create-expense-action.ts
"use server";

import { z } from "zod";
import { requireAuth } from "@/lib/server/auth-helpers";
import { serverApiClient } from "@/lib/server/api/client";
import { revalidatePath } from "next/cache";

// Zod ìŠ¤í‚¤ë§ˆ ì •ì˜
const createExpenseSchema = z.object({
  amount: z.number().positive("ê¸ˆì•¡ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤"),
  categoryId: z.string().min(1, "ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),
  description: z.string().optional(),
  date: z.string().optional(),
});

export async function createExpenseAction(
  prevState: FormState,
  formData: FormData
): Promise<FormState> {
  try {
    // 1. ì¸ì¦ í™•ì¸
    await requireAuth();

    // 2. ë°ì´í„° ì¶”ì¶œ ë° ë³€í™˜
    const rawData = {
      amount: Number(formData.get("amount")),
      categoryId: formData.get("categoryId")?.toString(),
      description: formData.get("description")?.toString(),
      date: formData.get("date")?.toString(),
    };

    // 3. Zod ê²€ì¦
    const validated = createExpenseSchema.safeParse(rawData);
    if (!validated.success) {
      return {
        success: false,
        errors: validated.error.flatten().fieldErrors,
        message: "ì…ë ¥ê°’ì„ í™•ì¸í•´ì£¼ì„¸ìš”",
      };
    }

    // 4. ë°±ì—”ë“œ API í˜¸ì¶œ
    await serverApiClient("/expenses", {
      method: "POST",
      body: JSON.stringify(validated.data),
    });

    // 5. í˜ì´ì§€ ì¬ê²€ì¦
    revalidatePath("/expenses");

    return { success: true, message: "ì§€ì¶œì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤" };
  } catch (error) {
    return {
      success: false,
      message: "ì§€ì¶œ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤",
    };
  }
}
```

### 2. ì»´í¬ë„ŒíŠ¸ ê°œë°œ

```typescript
// Server Component (ê¸°ë³¸)
export default async function ExpensePage() {
  const expenses = await getExpenses();
  return <ExpenseList expenses={expenses} />;
}

// Client Component (ìƒí˜¸ì‘ìš© í•„ìš”ì‹œ)
("use client");
export function ExpenseForm() {
  const [state, formAction] = useActionState(createExpenseAction, initialState);

  return (
    <form action={formAction}>
      {/* í¼ í•„ë“œ */}
      <SubmitButton pendingText="ì¶”ê°€ ì¤‘...">ì§€ì¶œ ì¶”ê°€</SubmitButton>
    </form>
  );
}
```

### 3. ë°±ì—”ë“œ API ê°œë°œ

```java
// Controller
@RestController
@RequestMapping("/families/{familyUuid}/expenses")
public class ExpenseController {

    @PostMapping
    public ResponseEntity<ApiSuccessResponse<ExpenseResponse>> createExpense(
        @LoginUser LoginUserDto user,
        @PathVariable String familyUuid,
        @Valid @RequestBody CreateExpenseRequest request
    ) {
        ExpenseResponse response = expenseService.createExpense(
            user.getUserUuid(),
            familyUuid,
            request
        );

        return ResponseEntity
            .status(HttpStatus.CREATED)
            .body(ApiSuccessResponse.of("ì§€ì¶œì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤", response));
    }
}

// Service
@Service
@Transactional
public class ExpenseService {
    public ExpenseResponse createExpense(
        CustomUuid userUuid,
        String familyUuid,
        CreateExpenseRequest request
    ) {
        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
        // ê²€ì¦, ë³€í™˜, ì €ì¥
        return ExpenseResponse.from(expense);
    }
}
```

### 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½

#### Backend - Flyway ë§ˆì´ê·¸ë ˆì´ì…˜

```sql
-- src/main/resources/db/migration/V1__init.sql
CREATE TABLE expenses (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    uuid VARCHAR(36) NOT NULL UNIQUE,
    family_uuid VARCHAR(36) NOT NULL,
    category_uuid VARCHAR(36) NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    description VARCHAR(1000),
    date DATETIME NOT NULL,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME,
    deleted_at DATETIME,
    INDEX idx_family_uuid (family_uuid),
    INDEX idx_deleted_at (deleted_at)
);
```

**ë§ˆì´ê·¸ë ˆì´ì…˜ í”„ë¡œì„¸ìŠ¤:**

1. Entity í´ë˜ìŠ¤ ìˆ˜ì •
2. Flyway SQL íŒŒì¼ ìƒì„± (`V{version}__{description}.sql`)
3. ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸
4. DTO ë° ê´€ë ¨ ì½”ë“œ ì—…ë°ì´íŠ¸
5. ì»¤ë°‹ ë° ë°°í¬

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### Frontend

- âŒ `.env.local` ì»¤ë°‹ ê¸ˆì§€
- âœ… Server Actionsì—ì„œ í•­ìƒ ì¸ì¦ í™•ì¸
- âœ… Zod ê²€ì¦ í•„ìˆ˜
- âŒ `any` íƒ€ì… ì‚¬ìš© ê¸ˆì§€

### Backend

- âœ… Flyway ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìˆ˜
- âŒ Productionì—ì„œ ì§ì ‘ ìŠ¤í‚¤ë§ˆ ìˆ˜ì • ê¸ˆì§€
- âœ… DTOë¥¼ í†µí•œ ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
- âœ… `@ControllerAdvice`ë¡œ í†µí•© ì—ëŸ¬ ì²˜ë¦¬

### ë°ì´í„°ë² ì´ìŠ¤

- âœ… ëª¨ë“  í…Œì´ë¸”/ì»¬ëŸ¼ì€ snake_case
- âœ… UUID ê¸°ë°˜ ê´€ê³„ ì„¤ì •
- âœ… Soft Delete íŒ¨í„´ (deleted_at)
- âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ë°˜ë“œì‹œ ì»¤ë°‹

---

## ğŸ”§ ìœ ìš©í•œ ëª…ë ¹ì–´

### Frontend ê°œë°œ

```bash
pnpm dev              # ê°œë°œ ì„œë²„ ì‹¤í–‰
pnpm build            # í”„ë¡œë•ì…˜ ë¹Œë“œ
pnpm lint             # ESLint ì‹¤í–‰
```

### Backend ê°œë°œ

```bash
./gradlew bootRun     # ê°œë°œ ì„œë²„ ì‹¤í–‰
./gradlew build       # ë¹Œë“œ
./gradlew test        # í…ŒìŠ¤íŠ¸
```

### ë°°í¬

```bash
vercel                # Frontend ë°°í¬ (Vercel)
# BackendëŠ” Railwayì—ì„œ ìë™ ë°°í¬
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ê·œì¹™

### ëª…ëª… ê·œì¹™

- **í…Œì´ë¸”ëª…**: snake_case (ì˜ˆ: `family_members`)
- **ì»¬ëŸ¼ëª…**: snake_case (ì˜ˆ: `created_at`, `family_uuid`)
- **ê´€ê³„**: UUID ê¸°ë°˜ (ì˜ˆ: `family_uuid` â†’ `families.uuid`)

### Entity ì˜ˆì‹œ

```java
@Entity
@Table(name = "expenses")
public class Expense {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(name = "uuid", unique = true, nullable = false)
    private String uuid;

    @Column(name = "family_uuid", nullable = false)
    private String familyUuid;

    @Column(name = "category_uuid", nullable = false)
    private String categoryUuid;

    @Column(name = "amount", nullable = false)
    private BigDecimal amount;

    @Column(name = "description", length = 1000)
    private String description;

    @Column(name = "date", nullable = false)
    private LocalDateTime date;

    @Column(name = "created_at", nullable = false)
    private LocalDateTime createdAt;

    @Column(name = "deleted_at")
    private LocalDateTime deletedAt;
}
```

---

## ğŸ”„ ìµœê·¼ ì£¼ìš” ê°œì„ ì‚¬í•­

### Next.js 15 Server Actions ì „í™˜ (2025-09)

- API Routes â†’ Server Actions íŒ¨í„´ìœ¼ë¡œ ì „í™˜
- Zero JavaScript by Default
- í–¥ìƒëœ SEO ë° ì„±ëŠ¥
- íƒ€ì… ì•ˆì „ì„± ê°•í™”

### íƒ€ì… êµ¬ì¡° ê°œì„  (2025-11)

- ë„ë©”ì¸ë³„ íƒ€ì… íŒŒì¼ ë¶„ë¦¬
- `src/types/actions/` í´ë” êµ¬ì¡°í™”
- ìœ ì§€ë³´ìˆ˜ì„± ë° í™•ì¥ì„± í–¥ìƒ

### Zod ê²€ì¦ ë„ì…

- ëª¨ë“  Server Actionsì—ì„œ Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦
- ëŸ°íƒ€ì„ íƒ€ì… ì•ˆì „ì„± ë³´ì¥
- ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ

### SubmitButton ì»´í¬ë„ŒíŠ¸

- `useFormStatus` Hook í™œìš©
- ì¤‘ë³µ ì œì¶œ ìë™ ë°©ì§€
- ë¡œë”© ìƒíƒœ ìë™ í‘œì‹œ

---

## ğŸ’¡ í•µì‹¬ ì›ì¹™

1. **Server Components ìš°ì„ **: ê¸°ë³¸ì€ Server Component
2. **íƒ€ì… ì•ˆì „ì„±**: TypeScript + Zod ì´ì¤‘ ê²€ì¦
3. **ë„ë©”ì¸ ë¶„ë¦¬**: íƒ€ì…ê³¼ ì•¡ì…˜ì„ ë„ë©”ì¸ë³„ë¡œ êµ¬ì¡°í™”
4. **API í†µì‹  ìµœì†Œí™”**: Server Actionsë¡œ ì§ì ‘ ë°±ì—”ë“œ í˜¸ì¶œ
5. **ì¼ê´€ëœ íŒ¨í„´**: ëª¨ë“  ê¸°ëŠ¥ì— ë™ì¼í•œ íŒ¨í„´ ì ìš©
6. **ì—ëŸ¬ ì²˜ë¦¬**: ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ì™€ ì²˜ë¦¬
7. **UX ê°œì„ **: ì¤‘ë³µ ì œì¶œ ë°©ì§€, ë¡œë”© ìƒíƒœ í‘œì‹œ

---

## ğŸ“š ì¤‘ìš” íŒŒì¼ë“¤

### Frontend

- `src/app/actions/` - Server Actions (ë„ë©”ì¸ë³„)
- `src/types/actions/` - íƒ€ì… ì •ì˜ (ë„ë©”ì¸ë³„)
- `src/components/ui/submit-button.tsx` - í¼ ì œì¶œ ë²„íŠ¼
- `src/lib/server/` - ì„œë²„ ìœ í‹¸ë¦¬í‹°
- `.cursor/rules/rules.mdc` - ê°œë°œ ê·œì¹™

### Backend

- `src/main/java/.../presentation/controller/` - REST API
- `src/main/java/.../application/service/` - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- `src/main/java/.../domain/entity/` - ì—”í‹°í‹°
- `src/main/resources/db/migration/` - Flyway ë§ˆì´ê·¸ë ˆì´ì…˜
