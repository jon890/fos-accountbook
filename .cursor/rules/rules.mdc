# ìš°ë¦¬ì§‘ ê°€ê³„ë¶€ - Cursor AI ê°œë°œ ê·œì¹™

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”
Next.js 15 + TypeScript + Prisma ORM + Tailwind CSSë¥¼ ì‚¬ìš©í•œ ê°€ì¡± ê°€ê³„ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜

## ğŸ“‹ ì½”ë”© ì»¨ë²¤ì…˜

### 1. ë°ì´í„°ë² ì´ìŠ¤ & API ì»¨ë²¤ì…˜
- **ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ëª…ê³¼ ì»¬ëŸ¼ëª…ì€ snake_case ì‚¬ìš©**
  - ì˜ˆ: `family_members`, `created_at`, `user_id`, `family_uuid`
- **UUID ê¸°ë°˜ ê´€ê³„ ì„¤ì •**: ëª¨ë“  í…Œì´ë¸” ê°„ ì¡°ì¸ì€ UUIDë¥¼ í†µí•´ ìˆ˜í–‰
  - ì˜ˆ: `family_uuid`, `category_uuid` ë“±
- **Soft Delete íŒ¨í„´**: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ í…Œì´ë¸”ì— `deleted_at` ì»¬ëŸ¼ ì‚¬ìš©

### 2. TypeScript íƒ€ì… ì•ˆì „ì„±
- **ì ˆëŒ€ `any` íƒ€ì… ì‚¬ìš© ê¸ˆì§€** - `unknown` ë˜ëŠ” ì •í™•í•œ íƒ€ì… ì‚¬ìš©
- **Prisma ê³µì‹ ì—ëŸ¬ íƒ€ì… ì‚¬ìš©**: `PrismaClientKnownRequestError` ë“±
- **Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦**: `error.issues` ì‚¬ìš© (not `error.errors`)

### 3. ì•„í‚¤í…ì²˜ íŒ¨í„´
- **Repository íŒ¨í„´**: ë°ì´í„° ì•¡ì„¸ìŠ¤ ë ˆì´ì–´ ë¶„ë¦¬
- **Service íŒ¨í„´**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìº¡ìŠí™”
- **ì˜ì¡´ì„± ì£¼ì…**: Containerë¥¼ í†µí•œ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬

### 4. API ì„¤ê³„
- **RESTful API ì„¤ê³„**
- **í†µì¼ëœ ì—ëŸ¬ ì²˜ë¦¬**: `handlePrismaError`, `handleValidationError` ì‚¬ìš©
- **BigInt ìë™ ì§ë ¬í™”**: API ì‘ë‹µì—ì„œ BigInt â†’ String ë³€í™˜
- **ì¸ì¦ ë˜í¼**: `withAuth` í•¨ìˆ˜ë¡œ ì¸ì¦ í†µí•© ì²˜ë¦¬

### 5. í”„ë¡ íŠ¸ì—”ë“œ ì»¨ë²¤ì…˜
- **React Hooks ìµœì í™”**: `useCallback`, `useMemo` ì ì ˆíˆ ì‚¬ìš©
- **Next.js Image ì»´í¬ë„ŒíŠ¸**: `<img>` íƒœê·¸ ëŒ€ì‹  `<Image />` ì‚¬ìš©
- **Tailwind CSS**: ì¼ê´€ëœ ìŠ¤íƒ€ì¼ë§
- **shadcn/ui**: UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ
- **Frontend**: Next.js 15, React 19, TypeScript, Tailwind CSS v3
- **Backend**: Next.js API Routes, Prisma ORM
- **Database**: Supabase (PostgreSQL)
- **Authentication**: NextAuth.js (Google OAuth)
- **Deployment**: Vercel
- **Package Manager**: pnpm

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
src/
â”œâ”€â”€ app/                 # Next.js App Router
â”‚   â”œâ”€â”€ api/            # API Routes
â”‚   â””â”€â”€ (pages)/        # Page Components
â”œâ”€â”€ components/         # React Components
â”‚   â”œâ”€â”€ ui/            # shadcn/ui Components
â”‚   â”œâ”€â”€ common/        # ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ feature/       # ê¸°ëŠ¥ë³„ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ lib/               # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”œâ”€â”€ repositories/      # ë°ì´í„° ì•¡ì„¸ìŠ¤ ë ˆì´ì–´
â”œâ”€â”€ services/          # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë ˆì´ì–´
â”œâ”€â”€ container/         # ì˜ì¡´ì„± ì£¼ì… ì»¨í…Œì´ë„ˆ
â””â”€â”€ types/            # TypeScript íƒ€ì… ì •ì˜
```

## ğŸš€ ê°œë°œ ê°€ì´ë“œë¼ì¸

### 1. ìƒˆë¡œìš´ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ ì‹œ
1. Repository ì¸í„°í˜ì´ìŠ¤ ì •ì˜
2. Repository êµ¬í˜„ì²´ ì‘ì„±
3. Service ë ˆì´ì–´ êµ¬í˜„
4. API Route ì‘ì„± (`withAuth` ì‚¬ìš©)
5. ì—ëŸ¬ ì²˜ë¦¬ ë° íƒ€ì… ì•ˆì „ì„± í™•ë³´

### 2. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‹œ
1. Prisma ìŠ¤í‚¤ë§ˆ ìˆ˜ì • (snake_case ì¤€ìˆ˜)
2. `npx prisma db push` ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±
3. Repository êµ¬í˜„ì²´ ì—…ë°ì´íŠ¸
4. íƒ€ì… ì •ì˜ í™•ì¸

### 3. ì»´í¬ë„ŒíŠ¸ ê°œë°œ ì‹œ
1. TypeScript Props ì¸í„°í˜ì´ìŠ¤ ì •ì˜
2. React Hooks ì˜ì¡´ì„± ìµœì í™”
3. ì—ëŸ¬ ë°”ìš´ë”ë¦¬ ê³ ë ¤
4. ì ‘ê·¼ì„± (a11y) ê³ ë ¤

## âš ï¸ ì£¼ì˜ì‚¬í•­
- **Production ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ `--force-reset` ì ˆëŒ€ ê¸ˆì§€**
- **í™˜ê²½ë³€ìˆ˜ (.env.local) ì»¤ë°‹ ê¸ˆì§€**
- **API í‚¤ ë° ë¯¼ê°í•œ ì •ë³´ ë…¸ì¶œ ê¸ˆì§€**
- **íƒ€ì… ì•ˆì „ì„±ì„ ìœ„í•´ ëŸ°íƒ€ì„ ê²€ì¦ í•„ìˆ˜**

## ğŸ”§ ìœ ìš©í•œ ëª…ë ¹ì–´
```bash
# ê°œë°œ ì„œë²„ ì‹¤í–‰
pnpm dev

# ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì ìš©
pnpm db:push

# Prisma Studio ì‹¤í–‰
pnpm db:studio

# ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„± ë° ì ìš©
pnpm db:migrate

# Prisma Client ìƒì„±
pnpm db:generate

# ìŠ¤í‚¤ë§ˆ ê²€ì¦
pnpm db:validate

# ë¹Œë“œ ë° ë°°í¬
pnpm build
vercel
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ê·œì¹™

### í…Œì´ë¸” ë° ì»¬ëŸ¼ ëª…ëª… ê·œì¹™
- **í…Œì´ë¸”ëª…**: snake_case (ì˜ˆ: `family_members`, `verification_tokens`)
- **ì»¬ëŸ¼ëª…**: snake_case (ì˜ˆ: `user_id`, `created_at`, `family_uuid`)
- **ê´€ê³„ ì»¬ëŸ¼**: UUID ê¸°ë°˜ (ì˜ˆ: `family_uuid`, `category_uuid`)

### ìŠ¤í‚¤ë§ˆ ì˜ˆì‹œ
```prisma
model FamilyMember {
  id          BigInt    @id @default(autoincrement())
  uuid        String    @unique @default(uuid()) @db.Uuid
  family_uuid String    @db.Uuid @map("family_uuid")
  user_id     String    @map("user_id")
  role        String    @default("member")
  joined_at   DateTime  @default(now()) @map("joined_at")
  deleted_at  DateTime? @map("deleted_at")

  family Family @relation("FamilyMembers", fields: [family_uuid], references: [uuid])
  user   User   @relation("UserFamilyMembers", fields: [user_id], references: [id])

  @@unique([family_uuid, user_id])
  @@map("family_members")
}
```

## ğŸ”„ ìµœê·¼ ì£¼ìš” ê°œì„ ì‚¬í•­ (2025-12-21)

### Repository ë ˆì´ì–´ ì•„í‚¤í…ì²˜ ê°œì„ 
- **ë¬¸ì œ**: Repositoryì—ì„œ `serialize()` í•¨ìˆ˜ ì‚¬ìš©ìœ¼ë¡œ Date ê°ì²´ê°€ ë¬¸ìì—´ë¡œ ë³€í™˜ë˜ì–´ ORM ì´ì  ìƒì‹¤
- **í•´ê²°**: 
  - Prismaê°€ ì œê³µí•˜ëŠ” Date ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€
  - BigIntì™€ Decimalë§Œ í•„ìš” ì‹œ ë¬¸ìì—´ë¡œ ë³€í™˜
  - `date.toLocaleDateString is not a function` ì˜¤ë¥˜ í•´ê²°

### íƒ€ì… ì•ˆì „ì„± ê°œì„ 
```typescript
// âŒ ê¸°ì¡´: ì§ë ¬í™”ë¡œ ì¸í•œ íƒ€ì… í˜¼ë™
interface ExpenseData {
  date: Date | string  // ë¶ˆì•ˆì •í•œ ìœ ë‹ˆì˜¨ íƒ€ì…
  amount: string | number
}

// âœ… ê°œì„ : ORM ë ˆì´ì–´ì—ì„œ ëª…í™•í•œ íƒ€ì… ìœ ì§€
interface ExpenseData {
  date: Date           // Date ê°ì²´ ìœ ì§€
  amount: string       // Repositoryì—ì„œ ì¼ê´€ëœ ë¬¸ìì—´ ë³€í™˜
}
```

### ë°ì´í„° íë¦„ ìµœì í™”
```
Prisma ORM â†’ Repository â†’ Service â†’ UI
     â†“            â†“        â†“       â†“
   Date         Date    Date    Date  âœ… Date ê°ì²´ ìœ ì§€
   Decimal   â†’ string  string  string âœ… ì¼ê´€ëœ ë³€í™˜
   BigInt    â†’ string  string  string âœ… ì¼ê´€ëœ ë³€í™˜
```

### í•µì‹¬ ì›ì¹™
1. **ORM ì´ì  í™œìš©**: Prismaì˜ íƒ€ì… ì•ˆì „ì„±ê³¼ Date ê°ì²´ë¥¼ ìµœëŒ€í•œ í™œìš©
2. **ìµœì†Œ ë³€í™˜**: ë°˜ë“œì‹œ í•„ìš”í•œ ê²½ìš°(BigInt, Decimal)ë§Œ ë¬¸ìì—´ë¡œ ë³€í™˜
3. **ì¼ê´€ëœ ì¸í„°í˜ì´ìŠ¤**: Repository ë ˆì´ì–´ì—ì„œ ì¼ê´€ëœ ë°ì´í„° í˜•íƒœ ì œê³µ
4. **API ì‘ë‹µ ì‹œì—ë§Œ Serialization**: ë„¤íŠ¸ì›Œí¬ ì „ì†¡ ì‹œì—ë§Œ serialize ì ìš©

### ì¤‘ìš” íŒŒì¼ë“¤
- `src/repositories/implementations/expense.repository.impl.ts`: Date ê°ì²´ ìœ ì§€ ë¡œì§
- `src/repositories/interfaces/expense.repository.ts`: ì •í™•í•œ íƒ€ì… ì •ì˜
- `src/components/expenses/ExpenseList.tsx`: Date ê°ì²´ ì§ì ‘ ì‚¬ìš©
- `src/lib/serialization.ts`: API ì‘ë‹µìš© ì§ë ¬í™” í•¨ìˆ˜ (Repositoryì—ì„œ ì‚¬ìš© ê¸ˆì§€)

### ë¬¸ì œ í•´ê²° ê³¼ì •
1. **ë¬¸ì œ ë°œê²¬**: `date.toLocaleDateString is not a function` ì—ëŸ¬ ë°œìƒ
2. **ì›ì¸ ë¶„ì„**: Repositoryì—ì„œ serialize í•¨ìˆ˜ë¡œ Date â†’ string ë³€í™˜
3. **ê·¼ë³¸ í•´ê²°**: ORM ë ˆì´ì–´ì—ì„œ Date ê°ì²´ ê·¸ëŒ€ë¡œ ìœ ì§€
4. **íƒ€ì… ì •ë¦¬**: ëª…í™•í•œ Date íƒ€ì… ì •ì˜ë¡œ íƒ€ì… ì•ˆì „ì„± í™•ë³´
5. **ë¹Œë“œ ê²€ì¦**: í”„ë¡œë•ì…˜ ë¹Œë“œ ì„±ê³µ í™•ì¸

ì´ ê°œì„ ìœ¼ë¡œ ì¸í•´ ORMì˜ ì¥ì ì„ ì™„ì „íˆ í™œìš©í•˜ë©´ì„œ íƒ€ì… ì•ˆì „ì„±ë„ í¬ê²Œ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.